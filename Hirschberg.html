<!--
University of Freiburg WS 2017/2018
Chair for Bioinformatics
Supervisor: Martin Raden
Author: Alexander Mattheis
-->

<div id="algorithm_description">
    <div class="description">
      <a href="https://dl.acm.org/citation.cfm?doid=360825.360861">Daniel S. Hirschberg</a>
      introduced 1974 an approach to compute the optimal global alignment of two sequences
      with only linear space, instead of quadratic space like in the
      <a href="https://doi.org/10.1016/0022-2836(70)90057-4">Needleman-Wunsch (1970)</a>
      algorithm.
      <br>
      <br>

      For the given input, the traceback steps are provided.
    </div>

    <div class="picture">
        <img src="Hirschberg-120x90.png">
    </div>
</div>

<div id="algorithm_input">
	<div class="row">
		<div class="colW100"><label>Sequence $a$:</label></div>
		<div class="colW400"><input class="sequence" data-bind="value: input.sequence1" id="sequence_1" placeholder="EXAMPLE 'ATC'"
                                    title="Allowed are A-Z and '-'." type="text"></div>
	</div>

	<div class="row">
		<div class="colW100"><label>Sequence $b$:</label></div>
		<div class="colW400"><input class="sequence" data-bind="value: input.sequence2" id="sequence_2" placeholder="EXAMPLE 'AGTC'"
                                    title="Allowed are A-Z and '-'." type="text"></div>
	</div>

	<div class="row">
		<div class="colW100"><label>Scoring in $s$:</label></div>

		<div class="colW400">
			<span class="group"> <!-- Microsoft Browsers will fallback on text-fields using following input type -->
				Match <input class="fx_parameter" data-bind="value: input.match" id="match" type="number">
				Mismatch <input class="fx_parameter" data-bind="value: input.mismatch" id="mismatch" type="number">
				Gap <input class="fx_parameter" data-bind="value: input.gap" id="gap" type="number">
			</span>

			 <div class="group_hint">
				<b>Hint:</b> <br>
				For similarity maximization, <br> match scores should be positive and all other scores lower. <br>
                For distance minimization the reverse applies.
			</div>
		</div>
	</div>
</div>

<div id="algorithm_output">
    <div class="scrollable">
        <!-- ko foreach: $root.output.recursionNumbersContainer -->
            <h2>Recursion <!-- ko foreach: $data --><span data-bind="text: $data"></span>.<!-- /ko --></h2>
            <span class="trace_function" data-bind="text: $root.output.traceFunctions()[$index()]"></span> <br>

            <div class="main_output">
                <table class="calculation">
                    <tbody>
                        <tr>
                            <th>
                                <small>
                                    <b>Row:</b> <br>
                                    i = <span data-bind="text: $root.output.currentGlobalRow()[$index()]"></span>
                                </small>
                            </th>
                            <th></th>
                            <!-- ko foreach: $root.output.secondSequences()[$index()] -->
                                <th>
                                    <span data-bind="text: $data"></span><sub><span data-bind="text: $root.output.secondSequencePositions()[$parentContext.$index()][$index()]"></span></sub>
                                </th>
                            <!-- /ko -->
                        </tr>

                        <tr>
                            <th><span data-bind="text: $root.output.matrixDLatex"></span></th>
                            <!-- ko foreach: $root.output.forwardRows()[$index()] -->
                                <td class="entry" data-bind="text: $data"></td>
                            <!-- /ko -->
                        </tr>

                        <tr>
                            <th><span data-bind="text: $root.output.matrixDPrimeLatex"></span></th>
                            <!-- ko foreach: $root.output.mirroredBackwardRows()[$index()] -->
                                <td class="entry" data-bind="text: $data"></td>
                            <!-- /ko -->
                        </tr>

                        <tr class="thick_line">
                            <th><span data-bind="text: $root.output.sumLatex"></span></th>
                            <!-- ko foreach: $root.output.addedRows()[$index()] -->
                                <!-- ko if: $root.output.highlightPositions()[$parentContext.$index()][1] == $index() -->
                                    <td class="result_entry" data-bind="text: $data"></td>
                                <!-- /ko -->

                                <!-- ko if: $root.output.highlightPositions()[$parentContext.$index()][1] != $index() -->
                                    <td class="entry" data-bind="text: $data"></td>
                                <!-- /ko -->
                            <!-- /ko -->
                        </tr>
                    </tbody>
                </table>
            </div>
        <!-- /ko -->
    </div>
</div>
